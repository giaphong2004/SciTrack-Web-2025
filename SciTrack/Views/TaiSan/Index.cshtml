@model List<SciTrack.web.Models.TaiSan>
@{
    ViewData["Title"] = "Tài sản KH&CN";
}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@ViewData["Title"]</title>

    <!-- ✅ Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- ✅ Bootstrap Icons (cho các icon bi bi-plus-circle, bi-trash, v.v.) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

    <!-- ✅ Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />

    <!-- ✅ File CSS riêng -->
    <link href="~/css/site.css" rel="stylesheet" />
    <link href="~/css/detai.css" rel="stylesheet" />
</head>

<body style="background-color:#f8fafc; font-family:'Inter',sans-serif;">

    <!-- NỘI DUNG CHÍNH -->
    <div class="flex-fill p-4">
        <h5 class="fw-bold text-primary">Phần mềm quản lý KHCN — Giao diện xanh dương</h5>
        @if (TempData["Message"] != null)
        {
            <div class="alert alert-info alert-dismissible fade show mt-2" role="alert">
                @TempData["Message"]
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        }
        <h6 class="fw-bold mb-3">TSKHCN — Tài sản KHCN</h6>

        @if (ViewBag.Error != null)
        {
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <strong>⚠️ Lỗi:</strong> @ViewBag.Error
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        }

        <div class="card shadow-sm border-0 rounded-3">
            <div class="card-body">
                @{
                    var selected = ViewBag.Selected as SciTrack.web.Models.TaiSan;
                }

                <div class="row">
                    <!-- 🟩 Form bên trái -->
                    <div class="col-md-6">
                        <form asp-controller="TaiSan" method="post">
                            <input type="hidden" name="Id" value="@(selected?.Id ?? 0)" />

                            <div class="row g-3">
                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Số danh mục (ĐI1.1)</label>
                                    <input type="text" name="SoDanhMuc" class="form-control" value="@(selected?.SoDanhMuc ?? "")" />
                                </div>

                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Tên (ĐI1.2)</label>
                                    <input type="text" name="Ten" class="form-control" value="@(selected?.Ten ?? "")" />
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label fw-semibold">Nguyên giá (ĐI1.3)</label>
                                    <input type="number" name="NguyenGia" class="form-control" value="@(selected?.NguyenGia ?? 0)" />
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label fw-semibold">Khấu hao (ĐI1.4)</label>
                                    <input type="number" name="KhauHao" class="form-control" value="@(selected?.KhauHao ?? 0)" />
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label fw-semibold">Hao mòn (ĐI1.5)</label>
                                    <input type="number" name="HaoMon" class="form-control" value="@(selected?.HaoMon ?? 0)" />
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label fw-semibold">Giá trị còn lại (ĐI1.6)</label>
                                    <input type="number" name="GiaTriConLai" class="form-control" value="@(selected?.GiaTriConLai ?? 0)" />
                                </div>

                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Trạng thái tài sản (ĐI1.7)</label>
                                    <input type="text" name="TrangThaiTaiSan" class="form-control" value="@(selected?.TrangThaiTaiSan ?? "")" />
                                </div>

                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Ngày cập nhật (ĐI1.8)</label>
                                    <input type="date" name="NgayCapNhat" class="form-control"
                                           value="@(selected?.NgayCapNhat?.ToString("yyyy-MM-dd") ?? "")" />
                                </div>

                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Mã số đề tài KH&CN (ĐI1.9)</label>
                                    <input type="text" name="MaDeTaiKHCN" class="form-control" value="@(selected?.MaDeTaiKHCN ?? "")" />
                                </div>
                            </div>

                            <!-- 🟣 Các nút thao tác -->
                            <div class="mt-4 d-flex gap-2 justify-content-start">
                                <button type="submit" formaction="/TaiSan/Create" class="btn btn-success">
                                    <i class="bi bi-plus-circle"></i> Thêm mới
                                </button>

                                <button type="submit" formaction="/TaiSan/Update" formmethod="post" class="btn btn-warning text-white">
                                    <i class="bi bi-pencil-square"></i> Sửa
                                </button>

                                <button type="submit" formaction="/TaiSan/Delete" formmethod="post"
                                        name="id" value="@(selected?.Id ?? 0)"
                                        class="btn btn-danger">
                                    <i class="bi bi-trash"></i> Xóa
                                </button>
                                <button type="button" class="btn btn-secondary">In</button>
                                <a href="/TaiSan/Index" class="btn btn-secondary">
                                    <i class="bi bi-x-circle"></i> Đóng
                                </a>
                            </div>
                        </form>
                    </div>

                    <!-- 🟦 Danh sách tài sản bên phải -->
                    <div class="col-md-5">
                        <h6 class="fw-bold mb-3">Danh sách đề tài KHCN</h6>
                        <div class="table-responsive">
                            <table class="table table-hover table-bordered align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width:25%">Mã</th>
                                        <th style="width:50%">Tên</th>
                                        <th style="width:25%">Trạng Thái</th>
                                    </tr>
                                </thead>
                                </thead>
                                <tbody>
                                    @foreach (var ts in Model)
                                    {
                                        <tr>
                                            <td colspan="3">
                                                <form method="get" asp-controller="TaiSan" asp-action="Index">
                                                    <input type="hidden" name="id" value="@ts.Id" />
                                                    <button type="submit" class="w-100 p-2 border-0 bg-transparent text-start">
                                                        <div class="row">
                                                            <div class="col-3 fw-semibold text-primary">@ts.SoDanhMuc</div>
                                                            <div class="col-5">@ts.Ten</div>
                                                            <div class="col-4 text-end">
                                                                <span class="badge-trangthai @(ts.TrangThaiTaiSan?.ToLower() == "sử dụng" ? "su-dung" : "khai-thac")">
                                                                    @ts.TrangThaiTaiSan
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </form>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                        <small class="text-muted">Click hàng để chỉnh sửa / in / xóa</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
</body>
</html>
