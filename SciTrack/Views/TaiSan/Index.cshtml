@model List<SciTrack.web.Models.TaiSan>
@{
    ViewData["Title"] = "Tài sản KH&CN";
    Layout = "_Layout";
    var selected = ViewBag.Selected as SciTrack.web.Models.TaiSan;
}

<main class="main-content">
    <div class="flex-fill p-4">
        <h5 class="fw-bold text-primary">Phần mềm quản lý KH&CN — Quản lý tài sản</h5>
       
        <h6 class="fw-bold mb-3">Tài sản KH&CN (chi tiết)</h6>

        @if (TempData["Message"] != null)
        {
            <div class="alert alert-info mt-2">@TempData["Message"]</div>
        }

        <div class="card shadow-sm border-0 rounded-3 mt-3">
            <div class="card-body">
                <div class="row">
                    <!-- 🟩 Form bên trái -->
                    <div class="col-md-6">
                        <form asp-controller="TaiSan" method="post">
                            <input type="hidden" name="Id" value="@(selected?.Id ?? 0)" />

                            <div class="row g-3">
                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Số danh mục</label>
                                    <input type="text" name="SoDanhMuc" class="form-control" value="@(selected?.SoDanhMuc ?? "")" />
                                </div>

                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Tên tài sản</label>
                                    <input type="text" name="Ten" class="form-control" value="@(selected?.Ten ?? "")" />
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label fw-semibold">Nguyên giá</label>
                                    <input type="number" name="NguyenGia" class="form-control" value="@(selected?.NguyenGia ?? 0)" />
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label fw-semibold">Khấu hao</label>
                                    <input type="number" name="KhauHao" class="form-control" value="@(selected?.KhauHao ?? 0)" />
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label fw-semibold">Hao mòn</label>
                                    <input type="number" name="HaoMon" class="form-control" value="@(selected?.HaoMon ?? 0)" />
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label fw-semibold">Giá trị còn lại</label>
                                    <input type="number" name="GiaTriConLai" class="form-control" value="@(selected?.GiaTriConLai ?? 0)" />
                                </div>

                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Trạng thái</label>
                                    <input type="text" name="TrangThaiTaiSan" class="form-control" value="@(selected?.TrangThaiTaiSan ?? "")" />
                                </div>

                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Ngày cập nhật</label>
                                    <input type="date" name="NgayCapNhat" class="form-control"
                                           value="@(selected?.NgayCapNhat?.ToString("yyyy-MM-dd") ?? "")" />
                                </div>

                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Mã đề tài KH&CN</label>
                                    <input type="text" name="MaDeTaiKHCN" class="form-control" value="@(selected?.MaDeTaiKHCN ?? "")" />
                                </div>
                            </div>

                            <!-- 🟣 Các nút thao tác -->
                            <div class="mt-4 d-flex flex-wrap gap-2">
                                <button type="submit" formaction="/TaiSan/Create" class="btn btn-success">
                                    <i class="bi bi-plus-circle"></i> Thêm
                                </button>

                                <button type="submit" formaction="/TaiSan/Update" class="btn btn-warning text-white">
                                    <i class="bi bi-pencil-square"></i> Sửa
                                </button>

                                <button type="submit" formaction="/TaiSan/Delete" name="id" value="@(selected?.Id ?? 0)"
                                        class="btn btn-danger">
                                    <i class="bi bi-trash"></i> Xóa
                                </button>

                                <button type="button" class="btn btn-secondary">
                                    <i class="bi bi-printer"></i> In
                                </button>

                                <a href="/TaiSan/Index" class="btn btn-secondary">
                                    <i class="bi bi-x-circle"></i> Đóng
                                </a>
                            </div>
                        </form>
                    </div>

                    <!-- 🟦 Danh sách tài sản bên phải -->
                    <div class="col-md-6">
                        <h6 class="fw-bold mb-3">Danh sách tài sản</h6>
                        <div class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width:25%">Mã</th>
                                        <th style="width:50%">Tên</th>
                                        <th style="width:25%">Trạng Thái</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var ts in Model)
                                    {
                                        <tr>
                                            <td colspan="3">
                                                <form method="get" asp-controller="TaiSan" asp-action="Index">
                                                    <input type="hidden" name="id" value="@ts.Id" />
                                                    <button type="submit" class="w-100 p-2 border-0 bg-transparent text-start">
                                                        <div class="row">
                                                            <div class="col-3 fw-semibold text-primary">@ts.SoDanhMuc</div>
                                                            <div class="col-5">@ts.Ten</div>
                                                            <div class="col-4 text-end">
                                                                <span class="badge-trangthai @(ts.TrangThaiTaiSan?.ToLower() == "sử dụng" ? "su-dung" : "khai-thac")">
                                                                    @ts.TrangThaiTaiSan
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </form>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                        <small class="text-muted">Chọn hàng để xem hoặc chỉnh sửa chi tiết</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
